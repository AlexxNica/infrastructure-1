                           GitHub Hooks
                           ************

GitHub Configuration
====================
Under the github repository settings, add a webhook URL:
        http://firehol.org/github-hook.php


Server configuration
====================
Only repositories and branches that are listed will in `etc/build.conf`
be built automatically (since only branches that the scripts understand how
to build can be used).


Nginx Configuration
===================
Add the following to the nginx server configuration:

	location /github-hook.php {
		alias /home/firehol/web/github-hook.php;
		fastcgi_pass  unix:/var/run/php-fpm.sock;
		include       fastcgi_params;
	}

The PHP script parses the incoming JSON and creates build instructions
in web/requests which are acted on by a cron-job.


Cron configuration
==================
Add the following to the firehol user's crontab:

~~~~
* * * * * $HOME/bin/process-requests etc/build.conf > /dev/null 2> /dev/null
~~~~


Appendix
========
Commit hooks:
  https://help.github.com/articles/post-receive-hooks

Handy for debugging:
  http://requestb.in/

  e.g. curl -X POST -d "fizz=buzz" http://requestb.in/1j5898a1
       firefox http://requestb.in/1j5898a1?inspect
