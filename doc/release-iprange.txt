                           iprange Release Process
                           ***********************

Pre-release
===========
Ensure everything is checked in that should be:
  git status

Perform a dry-run of the build:
  cd iprange
  git clean -dxf
  ./autogen.sh
  ./configure
  make dist

Run any further tests.


Release
=======
To release a new version of iprange, commit a change with up to date
configure.ac

Tag the commit with a signature:
  git tag -s v1.x.y -m "Release version 1.x.y"

N.B. pre-release tags should be of the form v1.x.y-pre.z or v1.x.y-rc.z
in order to comply with http://semver.org/ without limiting the number
of such releases.

Push the tag (origin is the default name of the remote repository):
  git push origin tag v1.x.y

The github hooks will automatically start the build process and
create a released tar-file.

If there is an error in the tag it is possible to move to a new commit,
delete the old tag locally, re-create it and push it over the old one:
  ....
  git tag -d v1.x.y
  git tag -s v1.x.y
  git push origin tag v1.x.y

If for some reason the tag needs removing entirely, it can be deleted
locally, from the remote server, and from the mirror:
  git tag -d v1.x.y
  git push origin :refs/tags/v1.x.y
  ssh firehol.org
  sudo -i -u firehol
  git --git-dir mirrors/iprange.git tag -d v1.x.y


Signing the results
====================
The outputs go to:
  http://firehol.org/download/iprange/unsigned/v1.x.y

Run the sign-iprange script, with no v on the version and with an
identifier for your GPG key e.g.:
  sign-iprange 1.x.y sanewall

This will check the signature in git, grab the bz2, gz and xz files
and compare the main scripts in sbin/ to ensure the contents all match.

If everything is OK, detached signatures will be created for each file.


Finally
=======
Upload the signatures to the host and move the directory to release:
  scp *.asc firehol.org:.
  ssh firehol.org
  d=/home/web/firehol/download/iprange
  v=1.x.y
  sudo -u firehol cp iprange-$v.*.asc $d/unsigned/v$v/
  sudo -u firehol mv $d/unsigned/v$v/ $d/releases/

If this is to be made the latest stable release:
  sudo -u firehol rm $d/latest
  sudo -u firehol ln -s $d/releases/v$v $d/latest

Announce on the mailing lists and website
